name: Excel File Validator

on:
  push:
    paths:
      - ScienceFair.xlsx
      - ExcelMonitor.java

jobs:
  validate_excel:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v3

    - name: Set Up Java
      uses: actions/setup-java@v3
      with:
        distribution: 'zulu'
        java-version: '17'

    - name: Download Apache POI
      run: |
        mkdir lib
        curl -L https://repo1.maven.org/maven2/org/apache/poi/poi/5.2.3/poi-5.2.3.jar -o lib/poi.jar
        curl -L https://repo1.maven.org/maven2/org/apache/poi/poi-ooxml/5.2.3/poi-ooxml.jar -o lib/poi-ooxml.jar

    - name: Compile Program
      run: javac -cp lib/*:. ExcelMonitor.java

    - name: Run Validator
      run: java -cp lib/*:. ExcelMonitor
